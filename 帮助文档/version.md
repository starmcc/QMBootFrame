# 更新日志

## V1.0.0 - Last Version

> 2019年6月2日15:27

1. 从现在开始，整合`qm-framework`、`qm-data`、`qm-security`版本将停止更新。

2. 在之后会直接添加Maven依赖来进行框架更新。

   > 请留意[Qm Framework](https://github.com/starmcc/qm-framework)、[Qm Data](https://github.com/starmcc/qm-data)、[Qm Security](https://github.com/starmcc/qm-security)

3. 从2018年8月份开始，由于本人技术有限，一直更新到2019年6月2日，前前后后修补各种bug，到1.0.0版本修正所有已知bug，如果后续需要，可单独联系本人提供技术支撑。

4. 删除dbcp2数据源的支持。

5. think you use it



## V0.9.9

> 2019年5月23日01:49

1. 对没错，是我，之前做了很多蠢无用功的基础设施，现在亲手把他们都干掉了。
2. 为了稳定，从`V0.9.9`开始，前面的版本将不在维护，届时只保留值得留念的`V0.9.84`版本。
3. 上述所说的"蠢"是把`QmSecurity`安全框架进行了缓存封装，从该版本开始，把所有基础缓存设置全部删除。需要做缓存相应的一些业务请直接在`realm`中实现。
4. 优化配置类的设置方法。
5. 剔除`Ecache`相关依赖，该缓存技术已经不适应当下的环境需求。框架内部已封装`redis`提供更友好的缓存服务。
6. 优化部分说明文档、部分代码注释。
7. 这是一个含泪版本。



## V0.9.84

> 2019年5月21日14:03

1. 增加`QmSecurity`在单点登录时，顶号返回状态提示。
2. 优化`token`生成机制。
3. 增加`QmCode`状态码。



## V0.9.83

> 2019年5月20日22:35

1. 优化全局变量及部分代码删减。
2. 已知在`QmSecurity`自动重新签发`token`时，前端异步请求导致没更新`token`请求被拦截问题，已修正，现在增加了重新签发`token`容忍缓冲时间，默认如果在`token`失效后再次请求时，`60`秒内如果没有使用最新`token`进行请求会在所有请求响应头中返回最新签发`token`。旧`token`在失效后第一次请求`60`秒后将失效，并拦截。
3. fix bugs。



## V0.9.82

> 2019年5月18日19:31

1. 优化部分逻辑代码
2. 该版本为可行版本，已有运用此版本框架的生产环境。
3. fix bugs



## V0.9.81

> 2019年5月16日23:07

1. 修正安全机制部分逻辑。
2. 该版本为试行版本
3. 优化安全框架`realm`的参数列表。



## V0.9.8

> 2019年5月16日00:32

1. 代码格式规范化，fix lot bugs
2. 优化部分注释，优化部分逻辑。
3. 修正部分帮助文档的错别信息，细化部分帮助文档说明。

## V0.9.7

> 2019年5月12日23:18

1. 本次更新内容较多，主要更新`QmSecurity`框架，并修复了N个Bug。
2. 修正`QmBase`使用`auto`系列方法时传递空的对象导致`SQL Error`的问题，现在底层判断为空情况下，会自动新建一个对象进行查询。
3. `QmSecurity`安全框架主体更新，基础架构变更，配置变更，使用缓存进行用户对象存储，增加`Realm`接口方法，增加缓存配置接口。本次更新为提供单点登录，用户实时校验做基础，剔除`JWT`的`token`生成依赖，现在使用框架自带的`token`生成方法。
4. 剔除`QmController`中`request`、`response`对象，并退出`spring`管理。
5. 配置文件更新，请留意帮助文档中的配置文件。
6. 优化`DataSource`配置，优化目录结构。
7. 优化部分异常处理，增加部分异常处理机制。
8. 从该版本开始，之前版本废弃处理，更新内容较多，请留意`V1.0.0`版本发布。发布后等待版本稳定，将`1.0`以下版本将`clear`处理。

## V0.9.4 Beta3

> 2019年5月7日11:51

1. 更新`QmSecurity`安全框架的认证机制，现在的`token`校验机制为 校验t`oken` 》过期重签`token` 》放置`Response`的`header`中，字段为`QmSecurityContent.headerTokenKeyName`的值。
2. 更新`QmSecurity`安全框架配置方法，新的配置在帮助文档中查看。
3. 现在的`QmSecurity`安全框架完全脱离`Spring`依赖，可单独抽离作为一个新的安全框架。
4. `token`校验机制依赖`Redis`，在配置中可以自己实现安全框架提供的`Redis`依赖方法，详细请查看帮助文档。
5. 添加部分`QmSecurity`的异常机制，报错信息一目了然。
6. 为了更好的维护框架，版本带有Beta是开发版本，只用作尝试性更新，请留意没有带Beta版本的发布。

## V0.9.3

> 2019年5月6日20:20

1. 增加`QmSecurity`安全框架的`Redis`权限缓存机制。详细请留意安全框架帮助文档。
2. 目前处于频繁更新状态，为了更好的维护框架，把大致的问题逐渐修复，将会在V1.0.1版本更改为稳定版本。



## V0.9.2

> 2019年5月5日17:36

1. 修正返回`json`格式数据时，特殊字符不会自动转义的bug。
2. 修正`QmBody`请求参数时，如果`required=false`前端传递空字符串报错的问题。



## V0.9.1

> 2019年5月5日11:46

1. 优化正则校验工具类，现在直接根据`verify.properties`来进行正则匹配。帮助文档更新配置文件格式。调用正则验证工具类`QmVerifyUtil.isRegex`即可。



## V0.9.0

> 2019年5月1日23:58

**5.1劳动节快乐**

1. 此次更新内容较多，涉及到配置文件若干，代码若干，如果使用之前版本的童鞋请慎重升级。
2. 在连接池的基础上增加了`dbcp2`连接池的支持，可在配置文件中选择一种连接池哦。
3. `druid`连接池配置优化。
4. 优化部分逻辑关系，修正`windows`旧版本打jar包时遇到的注入问题。
5. 添加`PageHelper`分页插件的支持。
6. 优化返回`msg`的文本信息，现在可以在配置文件中自由切换中文和英文的配置。
7. 对配置文件进行分离处理，增加`db.properties`用于数据源相关配置。
8. 优化整体框架的代码格式，多余错误导包清理。
9. 一些小`bug`的修正，配置文件更新。
10. 优化日志输出的样式配置，现在看上去更加舒服啦。



## V0.8.0

> 2019年4月18日15:44

1. 修正跨域支持的问题，使用CORS进行全局跨域支持。
2. 修正拦截器优先级别冲突问题。



## V0.7.6

> 2019年4月15日11:44

1. 修正`QmBase`在解析实体类字段时，如果设置为下划线风格，部分基本类型报错问题。这个问题我们将持续关注。

## V0.7.5

> 2019年4月12日14:56

1. 修正`QmBody`在`String`传递`null`字符串时如果`required=false`时，传值错误问题。
2. 删减`QmBody`中`parseAllFields`的属性和功能。

## V0.7.4

> 2019年4月10日18:10

1. 修正`QmSecurity`拦截器对`OPTIONS`跨域验证请求拦截的bug。

## V0.7.3

> 2019年2月28日13:02

1. 修正多余配置
2. 新增配置：`request.special.uri-[0]`, 该配置主要排除第三方API调用接口时特殊请求而框架自动解析json的问题。
3. 新增配置`Mybatis`的`resultMap`自动映射配置项

## V0.7.2

> 2019年2月26日18:02

1. 删除`QmSecurity`登录超时重定向路径功能，考虑到稳定性。
2. 删除框架底层报错视图返回的设置，考虑到稳定性。
3. 增加后台页面模板和部分基础视图框架`QMUI`。
4. 修正`QmBody`解析参数时如果为`List<实体类>`时，参数解析报json解析错误问题。
5. 修正`QmBody`如果参数解析为`null`时竟然不返回`100`参数错误的问题。
6. 修正`QmBase`主键策略的bug。
7. 增加`QmSecurity`静态路径排除设置。具体参照文档。
8. 修正`views`视图层的目录结构。
9. 修正框架中对于`views`视图层的访问路径。
10. 删减部分多余配置。

## V0.7.1
> 2019年2月12日04:25

1. 对于一些底层代码进行格式调优，V0.7.2版本将会进行全面`bug`测试，框架属于个人开发，存在的一些`bug`风险只能尽其所能解决，使用于企业开发时请注意风险规避。
2. 对于`QmSecurity`帮助文档进行改版更新，请仔细阅读避免降低开发效率。
3. 开设`QmSecurity`安全框架的`session机制`，并提供session监听接口`QmSecuritySessionEvent`，具体介绍请查看帮助文档。
4. 优化部分接口名称错误，类名命名错误等问题。


## V0.7.0
> 2019年2月11日20:52

1. `QmSecurity`安全框架迎来新的特性，增设`Session`模式校验。
2. 该版本尚未进行大幅度测试，待V0.7.1版本以上。
3. QmBootFrame增设配置`redirect.error.type`,遇到404或500时,是否使用重定向。
4. 具体最新配置请参照帮助文档。

## V0.6.1
> 2019年2月2日04:41

1. 修正配置文件`qm-frame.properties`中的`request.data-key`更变为`body.request.key`，`response.data-key`更变为`body.response.key`。
2. 新增AOP方法退出时触发`QmOutMethod`接口。可继承该接口。详细请查看帮助文档-[AOP切入接口]


## V0.6.0 beta1
> 2019年1月30日22:16

1. 分离框架配置,让`application.yml`做属于它需要做的事情。分离`QmFrame`配置出新的配置文件`qm-frame.properties`配置文件。所有关于框架的设置移到该配置文件当中。

2. 优化部分`application.yml`多余配置

3. 原本使用0.5.1更新0.6.0需要对配置文件进行重新部署，具体请参照帮助文档-配置文件

4. 删除`QmSecurityUtils`类，以`QmSecurityManager`进行代替。

## V0.5.1
> 2019年1月24日22:18

1. 修正`QmBase`中的 `Dto` 返回时，如果数据库字段是下划线命名规范，跟`java`实体不一致导致映射字段全部为`null`的问题
2. 修正`QmBase`在通用方法中如果字段名是数据库关键词导致SQL语法错误问题
3. 新增`QmBase`新特性，`@QmTable`可以设置`style`属性，该属性为`QmStyle`枚举类，用于数据库风格为下划线时通用数据持久层的支持。
4. 修正`@QmBody`标注`List<Map<String,Object>`时,导致异常的`bug`
5. 废弃`QmSecurityUtils`类，新的类`QmSecurityManager`进行代替。(V0.6版本以上将不在支持`QmSecurityUtils`)

> 实体类下划线映射官方配置

```yml
mybatis: 
  configuration:
    map-underscore-to-camel-case: true#是否启动数据库下划线自动映射实体
```


## V0.5.0 beta1
> 2019年1月22日23:26

1. verifyUtil 优化
2. 修正使用`QmBody`请求时，如果`List`类型中不是基本类型，获取数据则会存在`bug`
3. 优化异常信息
4. 已知`bug`的`QmBase`中的 `Dto` 返回时，如果数据库字段是下划线命名规范，跟`java`实体不一致导致映射字段全部为`null`的问题,下个版本将修正该bug.

## V0.4.2
> 2019年1月15日14:44

1. 修正部分重写request的异常机制。
2. 修正其他已知bug。

## V0.4.1
> 2019年1月14日18:58

1. 修正`QmBase`中增加修改删除的部分不合理的判断。
2. 增加`QmBase`中`autoSelectCount`方法。
3. `yml`中`mybatis-location`修正通配问题。
4. 注释掉请求时的多余日志输出。

## V0.4.0
> 2019年1月13日16:16

1. 紧急修正`QmBase`中存在的bug导致主键识别机制异常！
2. V0.4版本为实际项目不断优化的结果，实际项目上线则框架版本会提至V1.0.0
3. 申明：版本未达到V1.0.0以上请勿直接套用，V1.0.0以下为开发状态。
4. 修正部分说明文档的文字错漏

## V0.3.61
> 2019年1月9日12:36

1. 修正通用数据持久层部分逻辑。
2. 新增三个特有的实体类注解`@QmTable`、`@QmId`、`@QmParams`分别适用于数据持久层。
3. 新增通用数据持久层uuid特性。

## V0.3.5
> 2019年01月08日00:32

1. 修正QmSecurity框架依赖注入bug问题。
2. 修正QmController返回json信息转义问题。
3. 该版本对QmSecurity的配置有所影响，详细请查看最新帮助文档。

## V0.3.2
> 2019年01月03日23:45

1. 修正部分文本注释说明
2. 删减微信，百度等多余板块，框架更加纯粹

## V0.3.0
> 2018年12月24日02:05

1. `3DES`对称加密转为`AES`对称加密。（实际项目中发现3DES速度较为慢，为了优化速度，改变了加密算法）
   - 需要注意：V0.3.0版本以下的配置将不在适用
     - `3DES`部分替换成`aes`，详细请参照最新的配置文件。
2. `QmSecurity`安全框架迎来新的改变。
   - 现在权限控制将转为使用`URL`动态匹配规则进行鉴权。
   - 现在token将采用`AES`+`JWT`的双签加密机制，并且`AES`加密次数可动态配置。
   - 现在提供给调用者的实现方法只有一个，那就是授权方法。
   - 这是一个有点像`Shiro`安全框架的另类封装。
   - 现在的QmSecurity逻辑全面改变，总体调用更加方便，更加简洁。
   - 需要注意：V0.3.0版本以下的配置将不在适用
     - 配置文件`application.yml`的`security`配置相关
     - 详细请参照最新的配置文件
3. `QmCode`状态码更新部分内容
4. 增加`AES`前端示例相关部分内容
5. 该版本尚未测试，待**V0.3.1**版本更新方可尝试适用。

## V0.2.2
> 2018年12月16日00:37

1. 修正部分注释内容
2. 更新帮助文档安全框架相关说明
3. 增加安全框架获取所有角色的方法
4. 修正QmBody解析过程中，对于Date类型的解析装配。

## V0.2.1
> 2018年12月11日01:06

1. 修正返回JSON数据时带有转义符导致JSON不规范的问题
2. 优化Gwiki帮助文档结构

## V0.2.0
> 2018年12月9日23:22

1. 权限框架版本升级，现在利用更少的方法实现更多的事情。(部分逻辑变更请注意)
2. 权限框架自动缓存功能已经实现
2. 新增权限框架的示例Demo

## V0.1.0
> 2018年11月30日19:09

1. 修正框架部分冗余代码
2. 新增QmBody新特性
3. 补充部分注释、帮助文档信息
4. 修复权限框架中的错误逻辑

## V0.0.3
> 2018年11月26日00:02

1. 修正权限管理器的部分冗余代码
2. 修正权限管理器的获取用户信息接口
3. 补充部分注释，文档信息

## V0.0.2
> 2018年11月25日03:25

1. 增加权限管理器角色增删改查功能
2. 修正部分注释文本
3. 修正部分bug


## V0.0.1
> 2018年11月24日02:44

1. 修复过滤器加载两次的BUG
2. 修正框架大部分注释描述
3. 优化部分逻辑，执行效率